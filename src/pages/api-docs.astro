---
import Layout from "@/components/Layout.astro";
import { readFileSync } from "fs";
import { join } from "path";

// è¯»å–APIæ–‡æ¡£å†…å®¹
let apiContent = "";
try {
  const apiPath = join(process.cwd(), "API_TOOLS_README.md");
  apiContent = readFileSync(apiPath, "utf-8");
} catch (error) {
  console.error("æ— æ³•è¯»å–APIæ–‡æ¡£:", error);
  apiContent = "# APIæ–‡æ¡£\n\næ–‡æ¡£åŠ è½½å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•ã€‚";
}

// ç®€å•çš„Markdownè½¬HTMLå‡½æ•°
function markdownToHtml(markdown: string): string {
  return (
    markdown
      // æ ‡é¢˜
      .replace(
        /^### (.*$)/gim,
        '<h3 class="text-xl font-semibold text-gray-800 dark:text-gray-200 mt-6 mb-3">$1</h3>'
      )
      .replace(
        /^## (.*$)/gim,
        '<h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200 mt-8 mb-4">$1</h2>'
      )
      .replace(
        /^# (.*$)/gim,
        '<h1 class="text-3xl font-bold text-gray-800 dark:text-gray-200 mt-8 mb-6">$1</h1>'
      )
      // ä»£ç å—
      .replace(
        /```json\n([\s\S]*?)\n```/g,
        '<pre class="bg-gray-100 dark:bg-gray-800 rounded-lg p-4 overflow-x-auto mb-4"><code class="language-json text-sm">$1</code></pre>'
      )
      .replace(
        /```\n([\s\S]*?)\n```/g,
        '<pre class="bg-gray-100 dark:bg-gray-800 rounded-lg p-4 overflow-x-auto mb-4"><code class="text-sm">$1</code></pre>'
      )
      // è¡Œå†…ä»£ç 
      .replace(
        /`([^`]+)`/g,
        '<code class="bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded text-sm">$1</code>'
      )
      // ç²—ä½“
      .replace(/\*\*(.*?)\*\*/g, '<strong class="font-semibold">$1</strong>')
      // é“¾æ¥
      .replace(
        /\[([^\]]+)\]\(([^)]+)\)/g,
        '<a href="$2" class="text-blue-600 dark:text-blue-400 hover:underline" target="_blank" rel="noopener noreferrer">$1</a>'
      )
      // åˆ—è¡¨
      .replace(/^- (.*$)/gim, '<li class="ml-4 mb-1">â€¢ $1</li>')
      // æ®µè½
      .replace(/\n\n/g, '</p><p class="mb-4">')
      // åˆ†éš”çº¿
      .replace(
        /^---$/gim,
        '<hr class="border-gray-300 dark:border-gray-600 my-8">'
      )
      // åŒ…è£…æ®µè½
      .replace(/^([^<\n].*)$/gim, '<p class="mb-4">$1</p>')
      // æ¸…ç†å¤šä½™çš„æ®µè½æ ‡ç­¾
      .replace(/<p class="mb-4"><\/p>/g, "")
      .replace(/<p class="mb-4">(<h[1-6])/g, "$1")
      .replace(/(<\/h[1-6]>)<\/p>/g, "$1")
  );
}

const htmlContent = markdownToHtml(apiContent);
---

<Layout
  title="APIæ¥å£æ–‡æ¡£"
  description="å®Œæ•´çš„APIæ¥å£æ–‡æ¡£ - åŒ…å«æ‰€æœ‰å¯ç”¨çš„APIå·¥å…·æ¥å£è¯´æ˜"
  skipSrTitle={false}
>
  <div
    class="min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 dark:from-gray-900 dark:to-gray-800"
  >
    <div class="container mx-auto px-4 py-8">
      <!-- é¡µé¢æ ‡é¢˜ -->
      <div class="text-center mb-8">
        <h1 class="text-4xl font-bold text-gray-800 dark:text-gray-200 mb-4">
          ğŸ“– APIæ¥å£æ–‡æ¡£
        </h1>
        <p class="text-lg text-gray-600 dark:text-gray-400 mb-6">
          å®Œæ•´çš„APIå·¥å…·æ¥å£è¯´æ˜å’Œä½¿ç”¨ç¤ºä¾‹
        </p>
        <div class="flex justify-center gap-4">
          <a
            href="/tools"
            class="inline-flex items-center px-6 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors"
          >
            ğŸ”§ è¿”å›å·¥å…·ä¸­å¿ƒ
          </a>
          <a
            href="https://github.com"
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex items-center px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition-colors"
          >
            ğŸ“š GitHubæ–‡æ¡£
          </a>
        </div>
      </div>

      <!-- æ–‡æ¡£å†…å®¹ -->
      <div class="max-w-4xl mx-auto">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8">
          <!-- ç›®å½•å¯¼èˆª
          <div class="mb-8 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
            <h2
              class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-3"
            >
              ğŸ“‹ å¿«é€Ÿå¯¼èˆª
            </h2>
            <div
              class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2 text-sm"
            >
              <a
                href="#ip-åœ°å€å½’å±åœ°æŸ¥è¯¢æ¥å£"
                class="text-blue-600 dark:text-blue-400 hover:underline"
                >ğŸŒ IPå½’å±åœ°æŸ¥è¯¢</a
              >
              <a
                href="#whois-æŸ¥è¯¢æ¥å£"
                class="text-blue-600 dark:text-blue-400 hover:underline"
                >ğŸ” WHOISæŸ¥è¯¢</a
              >
              <a
                href="#ç«¯å£æ‰«ææ¥å£"
                class="text-blue-600 dark:text-blue-400 hover:underline"
                >ğŸ”Œ ç«¯å£æ‰«æ</a
              >
              <a
                href="#å…¬ç½‘-ip-æŸ¥è¯¢æ¥å£"
                class="text-blue-600 dark:text-blue-400 hover:underline"
                >ğŸ“ å…¬ç½‘IPæŸ¥è¯¢</a
              >
              <a
                href="#æ‰‹æœºå·ç å½’å±åœ°æŸ¥è¯¢æ¥å£"
                class="text-blue-600 dark:text-blue-400 hover:underline"
                >ğŸ“± æ‰‹æœºå·å½’å±åœ°</a
              >
              <a
                href="#åŸŸå-icp-å¤‡æ¡ˆä¿¡æ¯æŸ¥è¯¢æ¥å£"
                class="text-blue-600 dark:text-blue-400 hover:underline"
                >ğŸ“‹ ICPå¤‡æ¡ˆæŸ¥è¯¢</a
              >
              <a
                href="#åŸŸå-dns-è§£ææŸ¥è¯¢æ¥å£"
                class="text-blue-600 dark:text-blue-400 hover:underline"
                >ğŸŒ DNSè§£ææŸ¥è¯¢</a
              >
              <a
                href="#æ¯æ—¥æ–°é—»æ‘˜è¦å›¾ç‰‡ç”Ÿæˆæ¥å£"
                class="text-blue-600 dark:text-blue-400 hover:underline"
                >ğŸ“° æ¯æ—¥æ–°é—»å›¾ç‰‡</a
              >
              <a
                href="#ç¨‹åºå‘˜å†å²äº‹ä»¶æŸ¥è¯¢æ¥å£"
                class="text-blue-600 dark:text-blue-400 hover:underline"
                >ğŸ‘¨â€ğŸ’» ç¨‹åºå‘˜å†å²</a
              >
              <a
                href="#å®æ—¶å¤©æ°”ä¿¡æ¯æŸ¥è¯¢æ¥å£"
                class="text-blue-600 dark:text-blue-400 hover:underline"
                >ğŸŒ¤ï¸ å®æ—¶å¤©æ°”1</a
              >
            </div>
          </div> -->

          <!-- APIæ–‡æ¡£å†…å®¹ -->
          <div class="prose prose-lg max-w-none dark:prose-invert">
            <div set:html={htmlContent} />
          </div>

          <!-- åº•éƒ¨é“¾æ¥ -->
          <div
            class="mt-12 pt-8 border-t border-gray-200 dark:border-gray-600 text-center"
          >
            <div class="flex justify-center gap-4 mb-4">
              <a
                href="/tools"
                class="inline-flex items-center px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors text-sm"
              >
                ğŸ”§ ä½¿ç”¨APIå·¥å…·
              </a>
              <button
                onclick="window.scrollTo({top: 0, behavior: 'smooth'})"
                class="inline-flex items-center px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition-colors text-sm"
              >
                â¬†ï¸ è¿”å›é¡¶éƒ¨
              </button>
            </div>
            <p class="text-sm text-gray-500 dark:text-gray-400">
              æœ€åæ›´æ–°: {new Date().toLocaleDateString("zh-CN")}
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <style>
    /* è‡ªå®šä¹‰æ ·å¼ */
    .prose h1,
    .prose h2,
    .prose h3 {
      scroll-margin-top: 2rem;
    }

    .prose pre {
      white-space: pre-wrap;
      word-wrap: break-word;
    }

    .prose code {
      font-family: "Consolas", "Monaco", "Courier New", monospace;
    }

    /* å“åº”å¼è¡¨æ ¼ */
    .prose table {
      display: block;
      overflow-x: auto;
      white-space: nowrap;
    }

    /* é“¾æ¥æ ·å¼ */
    .prose a {
      word-break: break-all;
    }
  </style>
</Layout>
